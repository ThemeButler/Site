<?php

// Include Beans
require_once( get_template_directory() . '/lib/init.php' );


// Enqueue child theme assets
add_action( 'beans_uikit_enqueue_scripts', 'tbr_enqueue_uikit_assets', 5 );

function tbr_enqueue_uikit_assets() {

  $less_dir = get_stylesheet_directory() . '/assets/less/';

  // Include uikit overwrite folder
  beans_uikit_enqueue_theme( 'site', $less_dir . 'uikit' );

  // Add the theme style as a uikit fragment to have access to all the variables
  beans_compiler_add_fragment( 'uikit', $less_dir . 'style.less', 'less' );

  // Add the theme js as a uikit fragment
  beans_compiler_add_fragment( 'uikit', get_stylesheet_directory() . '/assets/js/theme.js', 'js' );

  // Cleanup AdsPro
  if( !is_page( 'order' ) ) :
      remove_action('wp_enqueue_scripts', 'BSA_PRO_add_custom_stylesheet');
      remove_action('wp_enqueue_scripts', 'BSA_PRO_add_stylesheet_and_script');
  endif;

  if( is_single() )
    beans_compiler_add_fragment( 'uikit', get_stylesheet_directory() . '/assets/js/blog-single.js', 'js' );

}

remove_theme_support( 'offcanvas-menu' );


// Remove unnecessary classes
add_filter( 'nav_menu_css_class', '__return_false' );


// Dequeue unnecessary uikit components
add_action( 'beans_uikit_enqueue_scripts', 'tbr_home_remove_uikit_components' );

function tbr_home_remove_uikit_components() {

  $components = array(
    'article',
    'alert',
    'breadcrumb',
    'badge',
    'comment',
    'dropdown',
    'form',
    'pagination',
    'table',
    'navbar',
    'nav',
    'icon',
    'offcanvas',
    'contrast'
  );
  beans_uikit_dequeue_components( $components );

}


// Setup theme
add_action( 'beans_before_load_document', 'tbr_setup_theme' );

function tbr_setup_theme() {

  beans_remove_attribute( 'beans_primary_menu', 'class' );
  beans_add_attribute( 'beans_primary_menu', 'id', 'js-mobile-nav' );
  beans_add_attribute( 'beans_fixed_wrap_header', 'class', 'uk-text-center' );
  beans_remove_attribute( 'beans_menu_navbar', 'id' );
  beans_remove_attribute( 'beans_header', 'role' );
  beans_remove_attribute( 'beans_footer', 'role' );
  beans_remove_attribute( 'beans_primary_menu', 'role' );
  beans_remove_action( 'beans_comments' );
  beans_remove_action( 'beans_replace_nojs_class' );
  beans_remove_action( 'beans_breadcrumb' );
  beans_remove_markup( 'beans_site' );
  beans_remove_markup( 'beans_content' );
  beans_add_attribute( 'beans_primary', 'role', 'main' );
  beans_add_attribute( 'beans_header', 'data-uk-sticky', '{top:0}' );
  beans_replace_attribute( 'beans_site_branding', 'class', 'uk-float-left', 'tm-logo uk-align-center tm-nudge' );
  beans_replace_attribute( 'beans_main', 'class', ' uk-block', ' uk-block-large' );
  beans_remove_attribute( 'beans_menu_navbar_primary', 'id' );
  beans_remove_attribute( 'beans_post', 'id' );
  beans_modify_action_hook( 'beans_footer', 'beans_main_after_markup' );
  beans_add_attribute( 'beans_menu_navbar', 'class', 'uk-hidden-small uk-subnav uk-subnav-line uk-margin-remove tm-nudge' );
  beans_add_attribute( 'beans_menu_item_link_24', 'class', 'tm-external' );
  beans_replace_attribute( 'beans_widget_area_grid_footer', 'class', 'uk-grid', 'uk-flex uk-flex-top uk-flex-space-between' );
  beans_remove_attribute( 'beans_widget_grid_footer', 'class' );
  beans_add_attribute( 'beans_menu_grid', 'class', 'uk-list' );
  beans_add_attribute( 'beans_widget_grid_footer_text_text-2', 'class', 'tm-about' );
  beans_add_attribute( 'beans_widget_grid_footer_text_text-3', 'class', 'tm-connect' );
  beans_remove_markup( 'beans_logo_image' );

  if ( is_page( 'Theme Setup Guide', 'Features' ) ) {
      beans_remove_attribute( 'beans_post', 'class', 'uk-panel-box' );
      beans_add_attribute( 'beans_post_title', 'class', 'uk-text-center' );
      beans_remove_markup( 'beans_main_grid');
      beans_remove_markup( 'beans_primary');
      beans_add_attribute( 'beans_post_content', 'class', 'tm-narrow-content' );
  }

}

// Include the needed uikit components
add_action( 'beans_uikit_enqueue_scripts', 'tbr_enque_uikit_global' );

function tbr_enque_uikit_global() {

  beans_uikit_enqueue_components( array( 'toggle', 'flex' ) );
  beans_uikit_enqueue_components( array( 'sticky' ), 'add-ons' );

}

// Add external link icon to a menu item
beans_add_smart_action( 'beans_site_title_link_prepend_markup', 'tbr_inline_svg_logo' );
function tbr_inline_svg_logo() { ?>
    <svg class="icon">
    <switch>
        <use xlink:href="#logo"></use>
        <foreignObject>
            <img class="icon" src="<?php get_stylesheet_directory(); ?>/assets/images/themebutler-logo.png" alt="ThemeButler Logo">
        </foreignObject>
    </switch>
</svg>
<? }


// Add external link icon to a menu item
beans_add_smart_action( 'beans_menu_item_link_24_append_markup', 'custom_add_external_link_icon' );
function custom_add_external_link_icon() { ?>
    <svg class="icon">
    <switch>
        <use xlink:href="#external-icon"></use>
        <foreignObject>
            <img class="icon" src="<?php get_stylesheet_directory(); ?>/assets/images/external-icon.png" alt="External">
        </foreignObject>
    </switch>
</svg>
<? }



// Add external link icon to a menu item
beans_add_smart_action( 'beans_head_append_markup', 'tbr_add_svg_sprite' );
function tbr_add_svg_sprite() { ?>

    <svg display="none" version="1.1" xmlns="http://www.w3.org/2000/svg">
        <defs>
            <symbol id="logo" viewBox="0 0 250 40">
                <title>ThemeButler Logo</title>
                <path d="M218.878845,22.2085676 C219.038077,22.2085676 219.69405,22.4093708 219.69405,23.443909 C219.69405,25.4546185 218.041951,26.935743 216.963298,27.5820616 C217.16009,24.0409639 218.570961,22.2085676 218.878845,22.2085676 L218.878845,22.2085676 L218.878845,22.2085676 Z M202.986314,13.1290495 C203.647577,13.173494 204.176587,13.6645248 204.176587,15.3153949 C204.176587,18.6631861 202.257866,23.8696118 199.643497,27.8669344 C199.554623,27.2725569 199.503309,26.632664 199.503838,25.9354752 C199.506483,18.6621151 202.57633,13.1290495 202.986314,13.1290495 L202.986314,13.1290495 L202.986314,13.1290495 Z M144.506855,22.0570281 C143.929704,21.9670683 142.040608,21.6206158 140.453048,21.5884873 C140.709618,18.3038822 141.151342,14.546988 141.895659,10.5646586 C142.260147,10.5277108 142.630984,10.5025435 143.016103,10.5025435 C146.277453,10.5025435 148.476549,12.6722892 148.51358,15.7373494 C148.560133,19.6045515 144.506855,22.0570281 144.506855,22.0570281 L144.506855,22.0570281 L144.506855,22.0570281 Z M134.11709,31.3004016 C132.719444,31.5360107 131.321799,29.2725569 131.321799,25.3111111 C131.321799,21.5499331 132.639564,16.8340027 135.549121,13.7475234 C133.893318,20.8093708 136.323063,30.9282463 134.11709,31.3004016 L134.11709,31.3004016 L134.11709,31.3004016 Z M116.337578,22.6599732 C116.497339,22.6599732 117.153312,22.8607764 117.153312,23.8953146 C117.153312,25.9231593 115.471588,27.4144578 114.393994,28.0516734 C114.480751,24.5004016 116.029694,22.6599732 116.337578,22.6599732 L116.337578,22.6599732 L116.337578,22.6599732 Z M68.544659,22.3563588 C68.703891,22.3563588 69.360393,22.557162 69.360393,23.5917001 C69.360393,25.6195448 67.678669,27.1108434 66.601075,27.7480589 C66.687833,24.1973226 68.236775,22.3563588 68.544659,22.3563588 L68.544659,22.3563588 L68.544659,22.3563588 Z M246.833344,24.6556894 C246.833344,26.546988 245.332541,33.4503347 241.61254,33.4503347 C239.411327,33.4503347 238.328972,31.368407 238.835235,28.3060241 C239.614996,23.594913 242.78853,21.2950469 242.78853,18.9855422 C242.78853,18.0987952 241.709877,16.6037483 240.722215,16.9876841 C238.826771,17.7250335 234.37409,19.3314592 232.787058,17.529585 C232.94682,15.939759 232.346922,12.0463186 231.586205,11.5558233 C231.586205,11.5558233 226.637312,11.0760375 226.637312,16.5427041 C226.637312,17.9772423 227.172142,19.8524766 228.414258,21.2248996 C227.690572,27.2971888 224.619137,33.2800535 221.051491,33.5659973 C218.946558,33.734672 217.724015,32.4254351 217.217223,30.5935743 C219.750125,29.9954485 224.044632,27.4647925 223.89598,22.3424364 C223.810809,19.4187416 222.150775,16.9876841 218.592121,16.9876841 C215.4334,16.9876841 210.863279,21.453012 210.634746,30.1105756 C209.651845,31.5799197 208.081742,33.206158 205.807526,33.5659973 C204.553242,33.7646586 203.168822,33.4519411 202.017166,32.523427 C208.154216,24.2680054 211.930293,11.7475234 208.981589,5.40910308 C208.416606,4.19464525 206.550257,3.35127175 204.529437,3.84712182 C201.61988,4.56144578 195.756328,12.9057564 195.756328,25.4449799 C195.756328,26.5534137 195.845202,29.0738956 196.412301,31.7416332 C195.133154,32.8725569 193.811686,33.5659973 192.543647,33.5659973 C190.163101,33.5659973 189.181257,31.1552878 189.087622,27.9435074 C188.983936,24.4104418 189.492315,20.913253 190.280012,17.7410977 C191.16293,17.7453815 192.083408,17.7250335 193.050969,17.6720214 C196.528683,17.4813922 197.0487,14.8971888 196.854025,14.0682731 C196.854025,14.0682731 196.773086,14.2069612 194.858068,14.3119143 C193.928597,14.3627845 192.741497,14.2380187 191.375592,14.0029451 C192.802863,9.768407 194.543836,6.51164659 195.51457,5.18580991 C195.51457,5.18580991 194.503102,3.55528782 192.076002,3.33413655 C189.872145,3.13333333 188.769687,3.78018742 188.769687,3.78018742 C188.162912,4.28406961 186.401836,7.5456493 184.94071,12.5550201 C178.677226,10.9807229 171.256797,8.9678715 165.913262,9.2607764 C159.640785,9.6040161 158.794898,13.6056225 158.91657,15.8776439 C158.99169,17.28166 159.973004,18.3001339 159.973004,18.3001339 C160.141758,18.1566265 162.761947,16.6594378 167.231556,16.1598394 C173.971678,15.4058902 178.456629,16.5668005 183.794344,17.2698795 C183.175931,20.4082999 182.756954,23.9547523 182.756954,27.7651941 C182.756954,29.0958501 182.847944,30.426506 183.03733,31.7009371 C182.223183,32.7124498 181.183677,33.5659973 179.977534,33.5659973 C177.00185,33.5659973 176.498761,27.1172691 178.413779,21.1975904 C178.753403,20.1480589 175.900979,18.6208835 172.396285,20.6621151 C171.592189,24.0372155 169.673997,33.1044177 167.202461,33.3073628 C165.978859,33.4080321 165.28903,32.1025435 165.284798,29.9606426 C165.275276,25.2307898 167.997563,19.8091031 168.030362,19.6752343 C167.236846,18.5036145 162.608005,19.2779116 161.625104,20.7772423 C160.604642,22.3344043 158.800717,25.9697456 158.491246,30.5078983 C157.469727,24.0757697 149.864673,23.1884873 149.864673,23.1884873 C151.63527,22.4811245 155.138907,19.2698795 155.316125,15.5488621 C155.54889,10.643909 151.215765,6.06934404 143.528715,6.06934404 C133.977431,6.06934404 126.686609,13.3014726 126.10364,23.8016064 C126.010534,25.4776439 126.152309,27.1943775 126.477121,28.8597055 C125.475704,30.2080321 122.561915,33.6597055 118.960941,33.6597055 C116.743858,33.6597055 115.299131,32.2631861 114.704523,30.5153949 C117.607732,30.1036145 121.512887,27.7341365 121.512887,23.0562249 C121.512887,19.3759036 118.898518,17.8947791 116.051383,17.8947791 C112.811195,17.8947791 108.07179,22.124498 108.07179,31.227577 C108.07179,31.8449799 108.123104,32.4977242 108.228377,33.161178 C107.620015,33.6281124 106.750322,34.145917 105.879042,34.145917 C102.268017,34.145917 103.972488,24.6792503 104.159758,23.0562249 C104.490389,20.1925033 102.991703,18.3852744 100.72119,18.3852744 C96.934004,18.3852744 93.826068,22.1780455 92.892894,24.729585 C93.047894,22.330656 92.961136,18.7017403 89.865896,18.653012 C84.766764,18.5726908 82.207941,25.1751004 82.207941,25.1751004 C82.373521,23.4663989 82.749118,20.7477912 83.583897,18.2958501 C83.311986,17.1354752 78.947649,17.1354752 77.794407,19.7475234 C77.794407,19.7475234 76.16241,24.9153949 76.341744,30.8891566 C75.170515,32.1914324 73.429013,33.508166 71.167493,33.508166 C69.054096,33.508166 67.642696,32.157162 66.999949,30.480589 C69.366212,30.2926372 73.625804,27.5740295 73.625804,22.4902276 C73.625804,18.9742972 71.255838,17.1354752 68.257936,17.1354752 C65.017747,17.1354752 60.278871,21.8208835 60.278871,30.9239625 C60.278871,31.3164659 60.296858,31.7228916 60.333359,32.1373494 C59.469485,32.8243641 58.281857,33.5119143 56.991071,33.5119143 C51.46926,33.5119143 58.842608,17.5911647 50.730762,17.5911647 C45.617347,17.5911647 42.437994,23.9269076 42.413131,24.1212851 C42.717841,21.5220884 43.480674,17.1825971 45.362364,12.6717537 C51.648595,13.0937082 58.058614,13.270415 64.070818,12.6053548 C72.177903,11.7084337 73.59618,7.8096385 73.59618,5.13226238 C73.59618,3.34323963 72.594763,1.60669344 71.996981,1 C71.996981,1 68.055854,6.48005355 54.879791,7.107095 C52.78967,7.206158 50.60856,7.1649264 48.370846,7.031593 C49.2453,5.73038822 50.235608,4.46934404 51.376684,3.29504685 C50.347758,1.71432396 47.349856,0.7772423 45.280367,1.50495315 C43.982705,2.40829987 42.668643,4.0896921 41.475724,6.38580991 C30.670157,5.08621151 19.293788,2.70174029 10.510627,3.67362784 C1.307962,4.69210174 -0.32139,9.3159304 0.04733,12.7317269 C0.363678,15.65917 2.210983,17.1606426 2.210983,17.1606426 C2.210983,17.1606426 3.776324,12.7681392 16.793684,11.3277108 C19.763549,10.998929 23.213755,11.0342704 26.973432,11.2404284 C24.925104,19.3507363 23.954899,31.2746988 25.814899,38.5641232 C26.699934,40.610174 28.247818,40.8843373 29.052972,40.8843373 C30.724645,40.8843373 31.995328,39.9028112 31.995328,39.9028112 C29.663979,30.2289157 32.091608,18.2053548 34.35207,11.7812584 C35.925347,11.9140562 37.528777,12.0543507 39.153897,12.1919679 C37.743027,16.7799197 36.813026,22.4655957 36.813026,28.7247657 C36.813026,34.5480589 37.937173,38.5539491 37.937173,38.5539491 C38.00859,38.7178046 38.664563,40.5801874 41.144035,40.5801874 C42.345946,40.5801874 43.580128,40.026506 43.580128,40.026506 C42.290929,33.8353414 45.074053,25.5788487 47.917484,25.5788487 C52.163851,25.5788487 44.956084,40.6257028 54.412145,40.6257028 C57.390474,40.6257028 60.050868,37.9317269 61.404076,36.2776439 C62.552558,38.7317269 64.682883,40.6963855 68.257936,40.6963855 C72.304336,40.6963855 75.239815,38.0452477 76.970737,35.8947791 C77.222546,36.9646586 77.55741,38.0232932 77.998605,39.0455154 C78.373144,39.647925 79.969169,40.6963855 82.283589,40.6963855 C83.429955,40.6963855 84.025092,40.4286479 84.151525,40.2171352 C83.268078,38.438822 82.739596,35.0610442 83.146934,32.7526104 C83.807668,29.0053548 85.494154,25.9991968 87.307601,25.9991968 C88.800469,25.9991968 87.508096,31.3255689 87.508096,34.3376171 C87.508096,38.1528782 88.773489,40.6963855 92.145931,40.6963855 C93.160044,40.6963855 93.953559,40.0939759 93.953559,40.0939759 C93.060061,35.497992 94.702109,25.9740295 97.330762,25.9740295 C99.093954,25.9740295 97.921667,30.8795181 97.921667,34.8730924 C97.921667,38.5769746 99.349995,40.8971888 102.986942,40.8971888 C106.13667,40.8971888 108.574879,38.2963855 109.558838,37.0471218 C110.835341,39.2789826 113.005341,41 116.351332,41 C122.209065,41 126.088827,36.3028112 127.841439,33.3212851 C129.79243,37.8904953 133.10668,41.152075 136.493405,40.4018742 C139.474908,39.7416332 140.17373,36.9368139 140.17373,33.6580991 C140.17373,33.1643909 139.993867,29.6457831 140.266307,24.4495315 C140.509652,25.0621151 140.886307,25.627577 141.431717,25.9713521 C142.96955,26.3954485 144.599961,25.8294511 145.857947,25.1692102 C145.857947,25.1692102 150.051413,26.3012048 150.051413,29.5552878 C150.051413,31.3946452 148.555372,32.7643909 146.696429,32.9036145 C144.180984,33.0921017 142.596598,31.8658635 142.596598,31.8658635 C141.80467,32.0077644 140.593236,33.6580991 140.593236,34.9314592 C140.593236,37.6195448 143.854585,41.2982597 150.051413,40.8736278 C154.974384,40.5362784 157.974932,37.4492637 158.511348,33.3555556 C158.792253,36.4864793 160.045478,40.3001339 164.039507,40.5384203 C168.92439,40.8297189 170.984356,34.7488621 171.742957,33.3062918 C171.969374,35.6564926 172.986661,40.5384203 177.53086,40.5384203 C180.643558,40.5384203 182.959565,38.2963855 184.367262,36.3933066 C185.530556,38.8768407 187.368867,40.5485944 190.030848,40.5485944 C192.822436,40.5485944 195.630423,39.096921 198.223633,36.7568942 C199.482148,38.924498 201.373361,40.5186078 204.220495,40.5186078 C207.937851,40.5186078 210.315224,37.9145917 211.585907,35.7871486 C212.693655,38.3975904 214.851489,40.5485944 218.592121,40.5485944 C226.717193,40.5485944 231.070949,29.9718876 232.167058,23.0546185 C233.078543,23.108166 234.262469,22.9876841 235.432111,22.6337349 C235.873305,23.5258367 231.75972,28.762249 231.825846,33.5103079 C231.870283,36.676573 233.397007,40.3547523 238.771753,40.5384203 C244.436926,40.7322624 250.001058,35.3378849 250,26.5159304 C250,25.2661312 247.775511,24.1593039 246.833344,24.6556894 L246.833344,24.6556894 L246.833344,24.6556894 Z" id="logo" sketch:type="MSShapeGroup"></path>
            </symbol>
            <symbol id="mark" viewBox="0 0 70 56">
                <title>ThemeButler Mark</title>
                <path d="M57.4639037,21.8220641 C55.4262137,23.7153025 51.6973682,25.3096085 47.7981598,26.2064057 C48.4977908,21.4234875 49.2978553,15.0462633 49.4978147,10.1637011 C49.5069457,10.1637011 51.09749,10.0640569 52.2972464,10.0640569 C56.2796348,10.0640569 59.2958254,11.5587189 60.2956224,14.0498221 C61.1925165,16.4412811 60.1956427,19.430605 57.4961908,21.8220641 L57.4639037,21.8220641 L57.4639037,21.8220641 Z M54.6814602,42.8469751 C53.6141646,46.633452 51.3974291,49.024911 48.9979162,49.024911 C48.2970672,49.024911 47.4982207,48.7259786 47.0983019,48.227758 C45.4855534,46.2348754 45.8985455,40.5551601 46.8983425,32.4839858 C48.5628529,32.2846975 50.5975915,31.9857651 52.2972464,31.5871886 C55.3161618,33.3807829 55.8965156,38.6619217 54.6967592,42.8469751 L54.6814602,42.8469751 L54.6814602,42.8469751 Z M54.6357783,3.38790036 C53.0874383,3.38790036 51.09749,3.48754448 49.2978553,3.68683274 C49.3076065,3.68683274 49.1978756,2.88967972 49.0978959,2.4911032 C48.8161798,0.996441281 46.4984237,0 43.4990327,0 C41.8102362,0 40.1997026,0.298932384 38.8999664,0.896797153 C39.3856342,2.19217082 39.8997634,5.08185053 39.8997634,5.08185053 C29.8021234,6.57651246 21.5034985,7.37366548 15.1047976,7.37366548 C8.90611062,7.37366548 4.2070102,6.67615658 1.10763947,5.28113879 C-0.379083511,8.96797153 -0.392056045,12.3558719 1.20761917,14.9466192 C2.46565357,17.0391459 4.7069087,18.4341637 7.50634033,18.633452 C8.24441509,18.7330961 9.00603585,18.7330961 9.90585316,18.7330961 C15.1375384,18.7330961 21.4035188,17.13879 26.4025038,15.8434164 C25.015213,22.8185053 23.4031128,33.0818505 23.8030316,39.4590747 C24.2026288,45.5373665 26.4025038,48.9252669 30.2017325,49.3238434 C30.4915049,49.4234875 30.701631,49.4234875 31.0015701,49.4234875 C32.5956413,49.4234875 33.701022,48.7259786 34.1009408,48.5266904 C31.7906707,40.455516 31.6014483,25.2099644 33.6010423,13.7508897 C35.5137463,13.1530249 38.4000679,12.3558719 40.5996214,11.7580071 C40.7235604,16.4412811 40.4996417,22.2206406 40.2996823,26.6049822 C39.0437121,26.5053381 37.6002303,26.405694 37.2003115,26.3060498 C36.8710528,26.9039146 36.5004536,28.2989324 36.6004333,29.594306 C36.8080671,31.1886121 37.9001694,31.886121 39.9997431,32.2846975 C39.6853352,38.0640569 39.3998649,44.4412811 40.0997228,48.4270463 C41.2309065,55.0035587 45.8985455,56 48.4980177,56 L48.5040201,56 C52.7095244,56 57.7961299,53.3096085 60.8955007,48.9252669 C63.8233792,44.6405694 65.0946481,39.658363 64.0948511,35.1743772 C63.5326761,32.4839858 61.8952977,30.2918149 59.4957848,28.8967972 C66.9567429,25.4092527 70.6935113,18.8327402 69.8936737,12.9537367 C68.9757448,6.57651246 63.794912,3.38790036 54.5967795,3.38790036 L54.6357783,3.38790036 L54.6357783,3.38790036 Z" id="Shape" fill="#FFFFFF" sketch:type="MSShapeGroup"></path>
            </symbol>
            <symbol id="external-icon" viewBox="0 0.002 32 32">
                <title>External Icon</title>
                <path d="M2,32c-1.103,0-2-0.896-2-2V2c0-1.104,0.897-2,2-2h13c0.553,0,1,0.447,1,1v2c0,0.553-0.447,1-1,1H4v24h24V17c0-0.553,0.447-1,1-1h2c0.553,0,1,0.447,1,1v13c0,1.104-0.897,2-2,2H2z"/>
                <path d="M31,0.002H21c-0.404,0-0.77,0.242-0.924,0.617c-0.155,0.373-0.069,0.803,0.217,1.09l3.586,3.586l-10,10c-0.391,0.391-0.391,1.023,0,1.414l1.414,1.414c0.393,0.391,1.025,0.391,1.416,0l9.999-10l3.585,3.586C30.484,11.9,30.74,12.002,31,12.002c0.129,0,0.259-0.025,0.383-0.078C31.757,11.771,32,11.404,32,11.002v-10C32,0.447,31.553,0.002,31,0.002z"/>
            </symbol>
            <symbol id="twitter-icon" viewBox="0 0 50 41" fill="#55ACEE">
                <title>External Icon</title>
                <path d="M0,36.3461306 C0.803663004,36.4417973 1.62142857,36.4907387 2.45054945,36.4907387 C7.26336996,36.4907387 11.6928571,34.8346712 15.2086081,32.0564595 C10.71337,31.9727973 6.91959707,28.9779505 5.61245421,24.8624369 C6.23956044,24.9834054 6.88315018,25.0482297 7.54505495,25.0482297 C8.48205128,25.0482297 9.38956044,24.9217207 10.2516484,24.684955 C5.55201465,23.7334595 2.01117216,19.5466577 2.01117216,14.5276667 C2.01117216,14.4840811 2.01117216,14.4406802 2.01190476,14.397464 C3.3970696,15.1733243 4.98095238,15.6392838 6.66501832,15.693027 C3.90860806,13.8354685 2.09487179,10.6648018 2.09487179,7.07102252 C2.09487179,5.17264865 2.6014652,3.39321171 3.48571429,1.86328378 C8.55238095,8.13037387 16.1217949,12.2543829 24.6595238,12.6863604 C24.4844322,11.9282297 24.3934066,11.1375946 24.3934066,10.3257207 C24.3934066,4.60511261 28.9930403,-0.0328738739 34.6664835,-0.0328738739 C37.6210623,-0.0328738739 40.2908425,1.2251982 42.1648352,3.23844595 C44.5047619,2.77377928 46.7032967,1.91167117 48.6880952,0.724702703 C47.9210623,3.14351802 46.2923077,5.17357207 44.1712454,6.45565315 C46.2492674,6.20522072 48.2291209,5.6483964 50.0714286,4.82451802 C48.6941392,6.90185135 46.952381,8.72635135 44.9454212,10.1868378 C44.9652015,10.6310045 44.9750916,11.0777568 44.9750916,11.5269099 C44.9750916,25.2155541 34.6424908,41 15.7472527,41 C9.9459707,41 4.54615385,39.2852027 0,36.3461306 L0,36.3461306 Z" id="bird"></path>
            </symbol>
            <symbol id="dribbble-icon" viewBox="0 0 50 50">
                <title>Dribble Icon</title>
                <path d="M25.0002551,0 C11.1927551,0 0.000255102041,11.1925 0.000255102041,25 C0.000255102041,38.8075 11.1927551,50 25.0002551,50 C38.8077551,50 50.0002551,38.8075 50.0002551,25 C50.0002551,11.1925 38.8077551,0 25.0002551,0 L25.0002551,0 L25.0002551,0 Z" id="ball" fill="#EA4C89"></path>
                <path d="M25.0002551,-0.000510204082 C11.1927551,-0.000510204082 0.000255102041,11.1919898 0.000255102041,24.9994898 C0.000255102041,38.8069898 11.1927551,49.9994898 25.0002551,49.9994898 C38.8077551,49.9994898 50.0002551,38.8069898 50.0002551,24.9994898 C50.0002551,11.1919898 38.8077551,-0.000510204082 25.0002551,-0.000510204082 L25.0002551,-0.000510204082 L25.0002551,-0.000510204082 Z M25.0002551,3.6219898 C30.4465051,3.6219898 35.4177551,5.6594898 39.1927551,9.0119898 C36.4190051,12.6707398 32.2052551,15.1069898 27.9827551,16.7557398 C25.6815051,12.5457398 22.8477551,8.1069898 19.9640051,4.2182398 C21.5777551,3.8282398 23.2640051,3.6219898 25.0002551,3.6219898 L25.0002551,3.6219898 L25.0002551,3.6219898 Z M15.9052551,5.6482398 C18.6915051,9.8169898 21.3915051,13.6832398 23.8590051,18.0594898 C17.6202551,19.6757398 10.5727551,20.6457398 4.0615051,20.6619898 C5.4340051,14.0019898 9.9077551,8.4719898 15.9052551,5.6482398 L15.9052551,5.6482398 L15.9052551,5.6482398 Z M41.5640051,11.4844898 C44.5465051,15.1332398 46.3427551,19.7869898 46.3777551,24.8582398 C41.4327551,23.8844898 36.5140051,23.6282398 31.5077551,24.1332398 C30.9440051,22.7294898 30.2627551,21.3969898 29.6090051,19.9582398 C33.9252551,18.2169898 38.5402551,15.2369898 41.5640051,11.4844898 L41.5640051,11.4844898 L41.5640051,11.4844898 Z M25.5952551,21.3669898 C26.1302551,22.5057398 26.7502551,23.7119898 27.3315051,24.9457398 C20.3690051,28.0157398 12.9640051,32.1182398 9.1190051,39.3107398 C5.7027551,35.5219898 3.6227551,30.5019898 3.6227551,24.9994898 C3.6227551,24.7907398 3.6265051,24.5819898 3.6327551,24.3744898 C11.0890051,24.3382398 18.4077551,23.4057398 25.5952551,21.3669898 L25.5952551,21.3669898 L25.5952551,21.3669898 Z M36.8915051,27.1957398 C39.9990051,27.1857398 43.2102551,27.6194898 46.1115051,28.3832398 C45.1627551,34.3532398 41.7402551,39.5019898 36.9277551,42.7419898 C35.7802551,37.5232398 34.6865051,32.5294898 32.7527551,27.4944898 C34.0865051,27.2957398 35.4790051,27.1994898 36.8915051,27.1957398 L36.8915051,27.1957398 L36.8915051,27.1957398 Z M28.7965051,28.4719898 C30.7677551,33.5619898 32.3140051,39.1994898 33.3515051,44.6857398 C30.7852551,45.7757398 27.9640051,46.3782398 25.0002551,46.3782398 C20.0565051,46.3782398 15.5040051,44.6982398 11.8827551,41.8794898 C15.7540051,35.5982398 21.7502551,30.8457398 28.7965051,28.4719898 L28.7965051,28.4719898 L28.7965051,28.4719898 Z" id="ball-lines" fill="#C32361"></path>
            </symbol>
            <symbol id="github-icon" viewBox="0 0 50 50" fill="#161614">
                <title>Github Icon</title>
                <path d="M0,25.633467 C0,36.9584555 7.1625894,46.5651047 17.0969029,49.954576 C18.3477086,50.1906116 18.8035237,49.3991056 18.8035237,48.719323 C18.8035237,48.1119247 18.7820375,46.4990147 18.7697597,44.3605321 C11.8158937,45.9089257 10.3486909,40.9238537 10.3486909,40.9238537 C9.21145523,37.9623936 7.57236256,37.1740347 7.57236256,37.1740347 C5.30249547,35.5847282 7.74425243,35.6161996 7.74425243,35.6161996 C10.2535376,35.7971603 11.5734062,38.2582249 11.5734062,38.2582249 C13.8033703,42.1748424 17.4253353,41.0434451 18.8495657,40.3872661 C19.0767059,38.7318697 19.7228276,37.6020459 20.4364775,36.9616026 C14.8853556,36.314865 9.04877375,34.1150132 9.04877375,24.2927848 C9.04877375,21.494976 10.0233279,19.2054306 11.6225176,17.4147071 C11.3646828,16.766396 10.5067682,14.1589893 11.8680745,10.6310438 C11.8680745,10.6310438 13.9660518,9.9418198 18.7421345,13.2589069 C20.73575,12.6892743 22.875165,12.4060315 25.0007674,12.3950166 C27.124835,12.4060315 29.2627152,12.6892743 31.2594002,13.2589069 C36.0324135,9.9418198 38.1273213,10.6310438 38.1273213,10.6310438 C39.4916971,14.1589893 38.6337825,16.766396 38.3774824,17.4147071 C39.9797416,19.2054306 40.9466221,21.494976 40.9466221,24.2927848 C40.9466221,34.1401903 35.1008318,36.3069972 29.5328279,36.9411462 C30.4291108,37.7326523 31.2287056,39.2967816 31.2287056,41.688609 C31.2287056,45.1142725 31.198011,47.8790363 31.198011,48.719323 C31.198011,49.4053999 31.6492219,50.2032002 32.9169097,49.9530025 C42.8435495,46.5556633 50,36.9553083 50,25.633467 C50,11.4760513 38.8056724,0 24.9976979,0 C11.1943276,0 0,11.4760513 0,25.633467 Z" id="octocat"></path>
            </symbol>
        </defs>
    </svg>
<? }


// Set the default layout to content only.
beans_add_filter( 'beans_default_layout', 'c' );


// Add the top ad section
add_action( 'beans_main_before_markup', 'tbr_top_ads' );

function tbr_top_ads() { ?>
  <div class="tm-top tm-media-block">
    <?php echo bsa_pro_ad_space('1'); ?>
  </div>
<? }


// Add the top ad section
add_action( 'beans_body_before_markup', 'tbr_top_alert_bar' );

function tbr_top_alert_bar() {
    if( is_front_page() || 'themes' == is_single('voyager') )
        return null;
    ?>
    <div class="jbar" data-init="jbar" data-jbar='{
        "message" : "Want to see what is coming next? Check out the preview of <strong>Voyager</strong>, our most comprehensive theme yet!",
        "button"  : "Check it out!",
        "url"     : "/2015/10/voyager-sneak-peek/",
        "state"   : "open"
    }'></div>
<? }


// Add the bottom ad section
add_action( 'beans_primary_menu_before_markup', 'tbr_mobile_menu_link' );

function tbr_mobile_menu_link() { ?>
    <button class="uk-button uk-visible-small uk-margin-top" data-uk-toggle="{target:'#js-mobile-nav', cls:'tm-nav-open'}">Show Navigation</button>
<? }

// Add the article lead class
add_filter( 'the_content', 'tbr_blog_post_content' );

function tbr_blog_post_content( $content ) {

	// Stop here if the excerpt is empty.
	if ( !has_excerpt() )
		return $content;

	// Add the excerpt as lead if it is singular.
	if ( is_singular('post') )
		return '<p class="uk-article-lead">' . get_the_excerpt() . '</p>' . $content;

	// Replace content with excerpt and more link if not singular.
    elseif ( is_home() )
		return '<p>' . get_the_excerpt() . '</p><p class="uk-margin-bottom-remove">'.  beans_post_more_link() .  '</p>';

}

// Register the help menu
register_nav_menus( array(
	'help' => 'Help Menu'
) );

// Register bottom widget area
beans_add_smart_action( 'widgets_init', 'banks_register_bottom_widget_area' );

function banks_register_bottom_widget_area() {

	beans_register_widget_area( array(
		'name' => 'Footer',
		'id' => 'footer',
		'description' => 'Widgets in this area will be shown in the footer section as a grid.',
		'beans_type' => 'grid'
	) );

}


// Add footer content
beans_modify_action_callback( 'beans_footer_content', 'tbr_footer' );

function tbr_footer() {

    echo beans_widget_area( 'footer' ); ?>

    <div class="tm-credits uk-margin-large-top uk-margin-bottom uk-text-muted uk-text-center uk-clearfix">
        &#169; ThemeButler <?php echo date('Y'); ?>. All rights reserved.
        Built with <a href="http://getbeans.io/" target="_blank" title="Build Smarter with Beans.">Beans</a> and <a href="https://wordpress.org/" target="_blank">WordPress</a>.
    </div>

    <!-- <script type="text/javascript">
    var _paq = _paq || [];
    _paq.push(["setDocumentTitle", document.domain + "/" + document.title]);
    _paq.push(["setCookieDomain", "*.themebutler.com"]);
    _paq.push(["setDomains", ["*.themebutler.com"]]);
    _paq.push(['trackPageView']);
    _paq.push(['enableLinkTracking']);
    (function() {
    var u="//stats.themebutler.com/";
    _paq.push(['setTrackerUrl', u+'piwik.php']);
    _paq.push(['setSiteId', 1]);
    var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0];
    g.type='text/javascript'; g.async=true; g.defer=true; g.src=u+'js/'; s.parentNode.insertBefore(g,s);
    })();
    </script>
    <noscript><p><img src="//stats.themebutler.com/piwik.php?idsite=1" style="border:0;" alt="" /></p></noscript> -->
<? }


// Set the content width
if ( ! isset( $content_width ) ) $content_width = 880;


// Add includes
do_action( 'themebutler_init' );


// Includes
require_once( get_stylesheet_directory() . '/inc/cleanup.php' );
require_once( get_stylesheet_directory() . '/inc/alert.php' );
require_once( get_stylesheet_directory() . '/inc/post-like.php' );
